# Basics
autoload -Uz compinit
compinit
autoload -Uz add-zsh-hook

# Environment Variables
export GITHUB_USERNAME=austinlparker

# Paths
. "$HOME/.cargo/env"
. "$HOME/.deno/env"

# History
HISTFILE=~/.zsh_history
HISTSIZE=10000
SAVEHIST=10000
setopt share_history hist_ignore_all_dups hist_ignore_space hist_verify

# Plugins
source $(brew --prefix)/share/zsh-autosuggestions/zsh-autosuggestions.zsh
source $(brew --prefix)/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh

# Auto-detect macOS appearance for starship theme
if [[ "$(defaults read -g AppleInterfaceStyle 2>/dev/null)" == "Dark" ]]; then
  export STARSHIP_CONFIG="$HOME/.config/starship.toml"
else
  export STARSHIP_CONFIG="$HOME/.config/starship-light.toml"
fi
eval "$(starship init zsh)"

# Aliases
alias ls='ls --color=auto'
alias ll='ls -la'
alias gs='git status'
alias cat='bat'

# Functions
glog() {
  git log --oneline --graph --decorate --all
}

# Autojump
[[ -s $(brew --prefix autojump)/etc/profile.d/autojump.sh ]] && . $(brew --prefix autojump)/etc/profile.d/autojump.sh

# Fuzzy Finder
[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

# ripgrep
if type rg &> /dev/null; then
  export FZF_DEFAULT_COMMAND='rg --files'
  export FZF_DEFAULT_OPTS='-m'
fi

# bun completions
[ -s "$HOME/.bun/_bun" ] && source "$HOME/.bun/_bun"

# bun
export BUN_INSTALL="$HOME/.bun"
export PATH="$BUN_INSTALL/bin:$PATH"

# pnpm
export PNPM_HOME="$HOME/Library/pnpm"
case ":$PATH:" in
  *":$PNPM_HOME:"*) ;;
  *) export PATH="$PNPM_HOME:$PATH" ;;
esac

# go
export PATH="$PATH:$(go env GOPATH)/bin"

# scripts
export PATH="$PATH:$HOME/scripts"

{{ if .isWork -}}
# hnytools (work only)
[ -f ~/.hnytools/hnytools.sh ] && . ~/.hnytools/hnytools.sh

# Claude OTEL exports (work only)
export OTEL_METRICS_EXPORTER=otlp
export OTEL_LOGS_EXPORTER=otlp
export OTEL_EXPORTER_OTLP_PROTOCOL=grpc
export OTEL_EXPORTER_OTLP_ENDPOINT=api.honeycomb.io:443
export OTEL_EXPORTER_OTLP_HEADERS="x-honeycomb-team={{ onepasswordRead "op://dev/honeycomb/credential" "my.1password.com" }},x-honeycomb-dataset=claude-code"
{{ end -}}
